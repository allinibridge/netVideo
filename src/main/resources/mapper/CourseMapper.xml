<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.earlymorning.netvideo.dao.CourseMapper">
  <resultMap id="BaseResultMap" type="cn.earlymorning.netvideo.beans.Course">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="course_id" jdbcType="INTEGER" property="courseId" />
    <result column="course_name" jdbcType="VARCHAR" property="courseName" />
    <result column="url" jdbcType="VARCHAR" property="url" />
    <result column="source_url" jdbcType="VARCHAR" property="sourceUrl" />
    <result column="course_descript" jdbcType="VARCHAR" property="courseDescript" />

    <result column="create_id" jdbcType="INTEGER" property="createId" />
    <result column="create_date"  property="createDate" />
    <result column="course_level" jdbcType="INTEGER" property="courseLevel" />
    <result column="sort" jdbcType="VARCHAR" property="sort" />
    <result column="hidden" jdbcType="INTEGER" property="hidden" />
    <result column="video_count" jdbcType="INTEGER" property="videoCount" />
    <result column="learning_count" jdbcType="INTEGER" property="learningCount" />
    <association property="courseType" javaType="cn.earlymorning.netvideo.beans.CourseType">
      <id column="type_id" property="typeId" jdbcType="INTEGER"></id>
      <result column="type_name" property="typeName" jdbcType="VARCHAR" />
      <result column="type_descript" property="typeDescript" jdbcType="VARCHAR" />
    </association>
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    course_id, course_name, url, source_url, course_descript, course_type, create_id,
    create_date, course_level, sort, hidden, video_count,learning_count
  </sql>
  <sql id="Type_Course_List">
    c.course_id, c.course_name, c.url, c.source_url, c.course_descript,  c.create_id,
    c.create_date, c.course_level, c.sort, c.hidden, c.video_count,c.learning_count,t.type_id,t.type_name,t.type_descript
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    SELECT
    <include refid="Type_Course_List" />
    FROM TB_SYS_COURSE c
    LEFT JOIN TB_COURSE_TYPE t
    ON c.course_type = t.type_id
    where course_id = #{courseId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from tb_sys_course
    where course_id = #{courseId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="cn.earlymorning.netvideo.beans.Course">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into tb_sys_course (course_id, course_name, url, 
      source_url, course_descript, course_type, 
      create_id, create_date, course_level,
      sort, hidden, video_count, learning_count
      )
    values (#{courseId,jdbcType=INTEGER}, #{courseName,jdbcType=VARCHAR}, #{url,jdbcType=VARCHAR}, 
      #{sourceUrl,jdbcType=VARCHAR}, #{courseDescript,jdbcType=VARCHAR}, #{courseType.typeId,jdbcType=INTEGER},
      #{createId,jdbcType=INTEGER}, #{createDate}, #{courseLevel,jdbcType=INTEGER},
      #{sort,jdbcType=VARCHAR}, #{hidden,jdbcType=INTEGER}, #{videoCount,jdbcType=INTEGER}, #{learningCount,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="cn.earlymorning.netvideo.beans.Course">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into tb_sys_course
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="courseId != null">
        course_id,
      </if>
      <if test="courseName != null">
        course_name,
      </if>
      <if test="url != null">
        url,
      </if>
      <if test="sourceUrl != null">
        source_url,
      </if>
      <if test="courseDescript != null">
        course_descript,
      </if>
      <if test="courseType != null">
        course_type,
      </if>
      <if test="createId != null">
        create_id,
      </if>
      <if test="createDate != null">
        create_date,
      </if>
      <if test="courseLevel != null">
        course_level,
      </if>
      <if test="sort != null">
        sort,
      </if>
      <if test="hidden != null">
        hidden,
      </if>
      <if test="videoCount != null">
        video_count,
      </if>
      <if test="learningCount != null">
        learning_count
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="courseId != null">
        #{courseId,jdbcType=INTEGER},
      </if>
      <if test="courseName != null">
        #{courseName,jdbcType=VARCHAR},
      </if>
      <if test="url != null">
        #{url,jdbcType=VARCHAR},
      </if>
      <if test="sourceUrl != null">
        #{sourceUrl,jdbcType=VARCHAR},
      </if>
      <if test="courseDescript != null">
        #{courseDescript,jdbcType=VARCHAR},
      </if>
      <if test="courseType != null">
        #{courseType.typeId,jdbcType=INTEGER},
      </if>
      <if test="createId != null">
        #{createId,jdbcType=INTEGER},
      </if>
      <if test="createDate != null">
        #{createDate},
      </if>
      <if test="courseLevel != null">
        #{courseLevel,jdbcType=INTEGER},
      </if>
      <if test="sort != null">
        #{sort,jdbcType=VARCHAR},
      </if>
      <if test="hidden != null">
        #{hidden,jdbcType=INTEGER},
      </if>
      <if test="videoCount != null">
        #{videoCount,jdbcType=INTEGER},
      </if>
      <if test="learningCount != null">
        #{learningCount,jdbcType=INTEGER}
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="cn.earlymorning.netvideo.beans.Course">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update tb_sys_course
    <set>
      <if test="courseName != null">
        course_name = #{courseName,jdbcType=VARCHAR},
      </if>
      <if test="url != null">
        url = #{url,jdbcType=VARCHAR},
      </if>
      <if test="sourceUrl != null">
        source_url = #{sourceUrl,jdbcType=VARCHAR},
      </if>
      <if test="courseDescript != null">
        course_descript = #{courseDescript,jdbcType=VARCHAR},
      </if>
      <if test="courseType != null">
        course_type = #{courseType.typeId,jdbcType=INTEGER},
      </if>
      <if test="createId != null">
        creste_id = #{createId,jdbcType=INTEGER},
      </if>
      <if test="createDate != null">
        create_date = #{createDate},
      </if>
      <if test="courseLevel != null">
        course_level = #{courseLevel,jdbcType=INTEGER},
      </if>
      <if test="sort != null">
        sort = #{sort,jdbcType=VARCHAR},
      </if>
      <if test="hidden != null">
        hidden = #{hidden,jdbcType=INTEGER},
      </if>
      <if test="videoCount != null">
        video_count = #{videoCount,jdbcType=INTEGER},
      </if>
      <if test="learningCount != null">
        learning_count = #{learnCount,jdbcType=INTEGER}
      </if>
    </set>
    where course_id = #{courseId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="cn.earlymorning.netvideo.beans.Course">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update tb_sys_course
    set course_name = #{courseName,jdbcType=VARCHAR},
      url = #{url,jdbcType=VARCHAR},
      source_url = #{sourceUrl,jdbcType=VARCHAR},
      course_descript = #{courseDescript,jdbcType=VARCHAR},
      course_type = #{courseType.typeId,jdbcType=INTEGER},
      create_id = #{createId,jdbcType=INTEGER},
      create_date = #{createDate},
      course_level = #{courseLevel,jdbcType=INTEGER},
      sort = #{sort,jdbcType=VARCHAR},
      hidden = #{hidden,jdbcType=INTEGER},
      video_count = #{videoCount,jdbcType=INTEGER}
      learning_count = #{learningCount,jdbcType=INTEGER}
    where course_id = #{courseId,jdbcType=INTEGER}
  </update>
  <select id="getCourses" resultMap="BaseResultMap">
    SELECT
      <include refid="Type_Course_List" />
    FROM TB_SYS_COURSE c
    LEFT JOIN TB_COURSE_TYPE t
    ON c.course_type = t.type_id
    WHERE (select count(*) from tb_sys_course where course_type=c.course_type and c.course_id > course_id) &lt;8
    ORDER BY c.course_type,c.course_id
  </select>
  <select id="getCoursesByTypeId" resultMap="BaseResultMap">
    SELECT
    <include refid="Type_Course_List" />
    FROM TB_SYS_COURSE c
    LEFT JOIN TB_COURSE_TYPE t
    ON c.course_type = t.type_id
    <if test="typeId!=0">
      WHERE c.course_type = #{typeId,jdbcType=INTEGER}
    </if>

  </select>
  <select id="search" resultMap="BaseResultMap">
    SELECT
    <include refid="Type_Course_List" />
    FROM TB_SYS_COURSE c
    LEFT JOIN TB_COURSE_TYPE t
    ON c.course_type = t.type_id
    WHERE c.course_name like concat('%',#{q},'%')
  </select>
</mapper>